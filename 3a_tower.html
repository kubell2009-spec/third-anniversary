<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>aeternum spire</title>

  <!-- Use your existing stylesheet -->
  <link rel="stylesheet" href="3a_style.css">

  <!-- Minimal layout tweaks (safe even if you already have these in 3a_style.css) -->
  <style>
    /* Ensure container and ascii positioning are correct */
    body { margin:0; min-height:100vh; display:flex; justify-content:center; align-items:center; }
    .container { text-align:center; width:100%; max-width:1100px; padding:28px; box-sizing:border-box; }

    /* ASCII block centered as an inline-block, but text inside left aligned */
    pre.ascii {
      display:inline-block;   /* shrink-wrap so centering works */
      text-align:left;        /* keep ASCII lines left-aligned */
      white-space:pre;
      margin: 0 0 18px 0;
      font-family: monospace;
      line-height:1.05;
    }

    /* Essay / long text box: contenteditable so typed text can be justified */
    .essay-box {
      width: 90%;
      max-width: 900px;
      min-height: 260px;
      padding: 14px;
      box-sizing: border-box;
      border: 2px solid #0f0;  /* will match your neon green */
      background: #000;        /* keeps the theme */
      color: #0f0;
      margin: 14px auto;
      text-align: justify;     /* make written paragraphs look like an essay */
      outline: none;
      overflow:auto;
      font-family: monospace;
    }

    /* Prompt area (question + buttons) centered */
    .prompt {
      margin-top: 18px;
    }
    .prompt .question {
      margin-bottom: 12px;
      max-width: 900px;
      margin-left:auto;
      margin-right:auto;
      text-align: center;
    }

    /* Buttons container (uses .btn from your stylesheet) */
    .choices { margin-top: 8px; }

    /* Story area where appended texts appear */
    .story {
      margin-top: 18px;
      max-width: 900px;
      margin-left:auto;
      margin-right:auto;
      text-align: left; /* story paragraphs left aligned inside centered column */
      font-family: monospace;
      line-height:1.4;
    }

    /* Restart button styling fallback if .btn isn't loaded for some reason */
    button.btn { /* should match your 3a_style.css .btn, safe fallback */
      display:inline-block; padding:10px 18px; margin:6px; cursor:pointer;
      border:1px solid #0f0; background:#000; color:#0f0; font-family:monospace; font-weight:bold;
    }
  </style>
</head>
<body>
  <div class="container">

    <!-- ASCII art: lines are left-aligned but the whole block is centered -->
    <pre class="ascii">
                          .- ._          *
                 .       (   ) `) ._,--.
          _.-.          (      .' | AE }      ._    +
        .'     )         `(_'-'   |--'"        ))        |
       (   _.   )                 |           '"       - * -
      .-.-'  )  _)  .        ["I"I"I"I"}   .             .
     (  `   .)`'              I_I_I_I_I
      `-. (   )          [UUUUI_I_I_I_I
         `-..'            |[__I_I_[#]_I .        .
                   +      |__[I_I_I=I_I
         .       ._    +  |]_ /   \-I_I    ._          ;
                 |~       |_[|     |I_[,   |~
               uuuuu      |__|     |I_I  uuuuu
               | #_|      |[ |TTTTT|I_I  | _ |
               |-  [      | [ %%I_g_%_I  |  -|         __a:f
          ---..|_  |.--,,'|]_ %_IaI_I_I -|_- |.------""
               |_-#|  ((  |_[   ]_I_!^!  | _ |      +
               |   |   )) |_[     ]_|"|  |_  |    n Am   n
             .-[_A_]_ '/  |_ T _Y_)_|`| -[N__]_        n
         ._.'        `- _.--'`'  ' "|\=\ ''    `-.
                      .'             |\=\`-._     `
                   .-'                  `:.  `---....__
                                           `
    </pre>

    <!-- Prompt + choices -->
    <div class="prompt" id="promptArea">
      <div class="question" id="questionText"> <!-- question text injected here --> </div>

      <div class="choices" id="choiceButtons">
        <!-- choice buttons are injected by JS -->
      </div>
    </div>

    <!-- Where story output appears -->
    <div class="story" id="storyArea" aria-live="polite"></div>
  </div>

<script>
/* --- EDITABLE: define steps and branching here --- */
const STEPS = [
  // step index 0
  {
    prompt: "you became dizzy as you enter the portal, you couldn't remember what happened.<br><br>before you lies a tall tower, with two smaller ones beside it.<br>all of them have moss and fungi growing on the sides.<br>around you is a dark empty field, there isn't really anywhere else to go.<br>you see ghosts flying in and out of the windows of the towers, muttering something to themselves.<br><br>there is a peculiar detail, in that there seems to be rubble stretching for kilometers on end away from the tower.<br>there must have been one big structure, or a lot of small structures around it.<br>how did the tower stay intact?<br><br>either way, the tower must hold something of note.<br>do you go in, or stay out here and observe?",
    yesText: "as you inch close, one of the ghosts possesses you.<br>it makes you smash your head into a wall, which kills you.",
    noText: "you observe.",
    nextYes: null,   // go to step 1 on YES
    nextNo: 1
  },

  // step index 1
  {
    prompt: "the ghosts seem to be wrapped up in their own things.<br>you try to think of a way to present yourself so that they would not become angered.<br>as you look around, you notice a few key things.<br><br>there are some trees around you, with fallen branches under them.<br>stones litter the ground.<br>besides that, though, nothing significant.<br><br>you turn your attention to the towers.<br>they're surely old, a lot of the bricks have fallen out already.<br>near the ground, there is a relatively large gap of missing material that you can see through.<br><br>you can see a painting on the inside.<br>a male and a female, disheartened, with a dark forest between them that cannot be traversed.<br><br>one of the branches is large enough for you to draw on the ground with.<br>do you replicate the painting, or do you draw the opposite?",
    yesText: "the phantoms see your drawing and realizes what it is.",
    noText: "the phantoms see your drawing.<br>they become offended and kill you.",
    nextYes: 2,    // YES -> step 2
    nextNo: null      // NO -> jump to step 4 (branch continues instead of ending)
  },

  // step index 2
  {
    prompt: "one of the ghosts fly over.<br>it asks you:<br><br>=how do you know of this painting?=<br>=do you know what it is?=<br>[not really.], you say; [but i would appreciate it if you could tell me?]<br>=certainly, though it's a long story.=<br><br>=long ago, there was a boy and his partner who looked much like you.=<br>=this was one of their settlements.=<br>=we hadn't existed back then, they created us for a more vibrant atmosphere.=<br>=the other ghosts have missed them since they left, which is why they're so irritable right now.=<br><br>=anyway, that painting was drawn together by the couple, as a reminder of what they had to go through.=<br>=it was a time when they had no physical connection, and only spoke through telepathy.=<br>=both of them agreed that it was a bad time to go through, but they also both agreed about its importance as a stepping stone for their relationship.=<br>=hence why we respect it too.=<br><br>=enough talk, do you want to head inside?=<br>=i can ask the others to let you in.=",
    yesText: "you agree.",
    noText: "you disagree.<br>[it's fine.]<br>[i don't want to disturb the peace of this place.]",
    nextYes: 3,    // YES -> step 3
    nextNo: null      // NO -> also goes to step 3 (both choices converge)
  },

  // step index 3
  {
    prompt: "the ghost speaks to the others in a tongue you can't understand.<br>however, you can sense their approval from their expressions.<br>=they're letting you in.=<br><br>=oh, and don't bother with the little side towers.=<br>=they were made for us.=<br>=each would have their own little tower to call home, but the ones further away from the main tower have all decayed, as we have fully dedicated our strength to preserving the main tower, and collaterally the side towers near it.=<br>=now then, shall we?=<br><br>you walk up the winding spiral staircase inside, careful not to trip on missing steps.<br>the walls are decorated with special artefacts, inscriptions and more paintings.<br>you assume they hold some intangible meaning, like the bracelet with the name of a mythological creature on it.<br><br>eventually, you reach the top of the tower, where there is a room equipped with everything needed to sustain life.<br><br>there are lots of cabinets and drawers, do you check them?",
    yesText: "you check the cabinets",
    noText: "[this is a beautiful room.]<br>[i don't want to disturb it though, so i'll be heading out now.]",
    nextYes: 4,    // YES -> step 4
    nextNo: null   // NO -> ends
  },

  // step index 4 (passcode step)
{
  type: "passcode",
  prompt: "you open each compartment, searching inside with your hands as it is too dark to see anything.<br>you pull out an assortment of items.<br>a diary, a stuffed monkey, notebooks for studying, books...<br>essentially, anything that could possibly belong in a bedroom is in the bedroom.<br><br>there's also a purple stuffed dinosaur with a green stomach which is constantly in an ear-to-ear grin.<br>it's disturbing.<br><br>you keep groping your way around.<br>more of those random items.<br>until only one cabinet is left before you, you open it and reach inside.<br>the backside of it is...<br><br>nonexistent?<br><br>you step inside and step towards the back.<br>you keep walking.<br>no wall to stop you.<br><br>you look back.<br>the doors are closed, no other way but forward.<br>in fact, there are strips of light trying to guide you forward.<br><br>as you walk, you hear a familiar voice.<br>your voice?<br>maybe you had some identical twin that you didn't know about.<br>or a doppelgänger.<br>in fact, there are multiple clones of that voice, saying different things.<br>they speak:<br><br>[[goodnight.]]<br>[[let's just break up, for real now.]]<br>[[my spark is gone.]]<br>[[me being your lover is troublesome and irritating.]]<br>[[who said we're talking tomorrow?]]<br><br>the statements are spoken again and again.<br>you become overwhelmed and try to cover your ears, but it does nothing.<br>the voices are coming from inside your head.<br>before you, words in starkly contrastive white materialize:<br><br>SEEK THE HATRED, FACE IT, AND DESTROY IT.<br>UTTER THE INCANTATION.",
  correctCode: "swordfish",   // 🔑 change this
  successText: "the voices diminish.",  // <--- put your secret here
  failureText: "the voices grow louder.",
}

];

const RESTART_LABEL = "restart";

/* --- runtime and UI references --- */
let stepIndex = 0;
const questionText = document.getElementById('questionText');
const choiceButtons = document.getElementById('choiceButtons');
const storyArea = document.getElementById('storyArea');

/* Render the current prompt according to nextYes/nextNo */
function renderPrompt() {
  if (stepIndex >= STEPS.length) {
    questionText.textContent = "End of path.";
    choiceButtons.innerHTML = '';
    appendParagraph(FINAL_TEXT);
    choiceButtons.appendChild(createRestartButton());
    return;
  }

  const step = STEPS[stepIndex];
  questionText.innerHTML = step.prompt;
  choiceButtons.innerHTML = '';

  // --- Special case: passcode step ---
  if (step.type === "passcode") {
    const input = document.createElement('input');
    input.type = 'password';
    input.placeholder = "enter passcode";
    input.className = "password-input";
    choiceButtons.appendChild(input);

    const submit = document.createElement('button');
    submit.className = 'btn';
    submit.textContent = 'Submit';
    submit.addEventListener('click', () => {
      if (input.value === step.correctCode) {
        questionText.innerHTML = "the voices shriek all at once, and dissipate.<br>the letters before you morph and jumble around, forming new sentences.<br>it's quite satisfying seeing them dance, leaving luminous trails in their wake.<br>they read:<br><br>THIS TOWER, IT TOOK YEARS TO BUILD.<br>ITS MAKERS PATIENTLY ADDED A FEW BRICKS EVERYDAY, UNTIL IT ROSE ABOVE THE HEAVENS.<br>AT FIRST WHEN THE BRICKS FELL OUT, THEY SCOLDED EACH OTHER FOR BEING NEGLIGENT.<br>THOSE DAYS, THEY WOULD NOT GET ANYTHING DONE.<br><br>EVENTUALLY, THEY LEARNT TO FORGIVE.<br>THEY LEARNT TO COMMUNICATE.<br>AND SO, IF THEY MADE MISTAKES AND THE BRICKS WERE LOOSE, THEY WOULD WORK TOGETHER TO FIX THEM.<br><br>YOU WILL REALIZE THAT THIS TOWER WAS NOT BUILT FROM CLAY, BUT FROM FIDELITY AND ACCEPTANCE.<br>ANY PHYSICAL BARRIERS ARE FUTILE IN THE FACE OF SPIRITUAL CONNECTION.<br>SUCH IS WHY THE PHANTOMS PRESERVE THIS STRUCTURE PURELY FOR THE SAKE OF THEIR MASTERS.<br>SUCH IS WHY YOU CAME BACK HERE, TO REDISCOVER YOURSELF.<br><br>beneath your feet, characters begin to shine in a ring around you.<br>they read:<br><br>";
        appendParagraph(step.successText || "Correct!");

        // ✅ Instead of restart, show Return button
        choiceButtons.innerHTML = '';
        const returnBtn = document.createElement('button');
        returnBtn.className = 'btn';
        returnBtn.textContent = 'return';
        returnBtn.addEventListener('click', () => {
          appendParagraph("returning...");
          choiceButtons.innerHTML = '';
          setTimeout(() => {
            window.location.href = "3a_portal.html";
          }, 1000); // 1000 ms = 1 second
        });
        choiceButtons.appendChild(returnBtn);

      } else {
        appendParagraph(step.failureText || "incorrect.");
        input.value = "";
        input.focus();
      }
    });
    choiceButtons.appendChild(submit);
    return; // stop here so YES/NO buttons aren't created
  }

  // --- Default case: YES/NO branching ---
  const yesBtn = document.createElement('button');
  yesBtn.className = 'btn';
  yesBtn.textContent = 'yes';
  yesBtn.addEventListener('click', () => {
    appendParagraph(step.yesText || '');
    if (typeof step.nextYes === 'number') {
      stepIndex = step.nextYes;
      renderPrompt();
    } else {
      choiceButtons.innerHTML = '';
      appendParagraph(step.endTextYes || '(branch ended)');
      choiceButtons.appendChild(createRestartButton());
      questionText.innerHTML = "(branch ended)";
    }
  });
  choiceButtons.appendChild(yesBtn);

  const noBtn = document.createElement('button');
  noBtn.className = 'btn';
  noBtn.textContent = 'no';
  noBtn.addEventListener('click', () => {
    appendParagraph(step.noText || '');
    if (typeof step.nextNo === 'number') {
      stepIndex = step.nextNo;
      renderPrompt();
    } else {
      choiceButtons.innerHTML = '';
      appendParagraph(step.endTextNo || '(branch ended)');
      choiceButtons.appendChild(createRestartButton());
      questionText.innerHTML = "(branch ended)";
    }
  });
  choiceButtons.appendChild(noBtn);
}

/* Utility to append story paragraphs */
function appendParagraph(text) {
  const p = document.createElement('p');
  p.style.margin = '10px 0';
  p.innerHTML = text;
  storyArea.appendChild(p);
  p.scrollIntoView({ behavior: 'smooth', block: 'end' });
}

/* Restart button */
function createRestartButton() {
  const r = document.createElement('button');
  r.className = 'btn';
  r.textContent = RESTART_LABEL;
  r.addEventListener('click', () => {
    restartAdventure();
  });
  return r;
}

function restartAdventure() {
  stepIndex = 0;
  storyArea.innerHTML = '';
  renderPrompt();
  // optional: reset essay box
  // document.querySelector('.essay-box').innerHTML = '(write your essay here...)';
}

/* Initialize */
(function init(){
  renderPrompt();
})();
</script>

</body>
</html>























